

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> promptManager.js</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Global</h3><ul><li><a href="global.html#createDirectories">createDirectories</a></li><li><a href="global.html#createExamplePrompts">createExamplePrompts</a></li><li><a href="global.html#createPrompt">createPrompt</a></li><li><a href="global.html#createPromptStructure">createPromptStructure</a></li><li><a href="global.html#deletePrompt">deletePrompt</a></li><li><a href="global.html#fileExists">fileExists</a></li><li><a href="global.html#generateId">generateId</a></li><li><a href="global.html#getAllPrompts">getAllPrompts</a></li><li><a href="global.html#getPromptById">getPromptById</a></li><li><a href="global.html#getPromptsStats">getPromptsStats</a></li><li><a href="global.html#incrementUsage">incrementUsage</a></li><li><a href="global.html#readJSONFile">readJSONFile</a></li><li><a href="global.html#searchPrompts">searchPrompts</a></li><li><a href="global.html#updatePrompt">updatePrompt</a></li><li><a href="global.html#writeJSONFile">writeJSONFile</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>promptManager.js</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// ===== GERENCIADOR DE PROMPTS =====
// Este mÃ³dulo Ã© responsÃ¡vel por todas as operaÃ§Ãµes relacionadas aos prompts

import { readJSONFile, writeJSONFile, fileExists } from './fileUtils.js';
import { config, defaultCategories } from '../config/config.js';
// Removido import do uuid pois criamos funÃ§Ã£o prÃ³pria

/**
 * Gera um ID Ãºnico simples (substituto do uuid)
 * @returns {string} ID Ãºnico
 */
function generateId() {
  return Date.now().toString(36) + Math.random().toString(36).substr(2);
}

/**
 * Estrutura padrÃ£o de um prompt
 * @param {Object} promptData - Dados do prompt
 * @returns {Object} Prompt formatado
 */
function createPromptStructure(promptData) {
  const now = new Date().toISOString();
  
  return {
    id: promptData.id || generateId(),
    title: promptData.title || '',
    description: promptData.description || '',
    content: promptData.content || '',
    category: promptData.category || 'Geral',
    tags: Array.isArray(promptData.tags) ? promptData.tags : [],
    tone: promptData.tone || 'Neutro',
    createdAt: promptData.createdAt || now,
    updatedAt: now,
    isExample: promptData.isExample || false,
    usageCount: promptData.usageCount || 0
  };
}

/**
 * Carrega todos os prompts do arquivo
 * @returns {Promise&lt;Array>} Lista de prompts
 */
export async function getAllPrompts() {
  try {
    console.log('ðŸ“‚ Carregando prompts...');
    
    const prompts = await readJSONFile(config.data.promptsFile);
    
    // Se arquivo estÃ¡ vazio, criar prompts de exemplo
    if (!prompts || prompts.length === 0) {
      console.log('ðŸ“ Criando prompts de exemplo...');
      const examplePrompts = createExamplePrompts();
      await writeJSONFile(config.data.promptsFile, examplePrompts);
      return examplePrompts;
    }
    
    console.log(`âœ… ${prompts.length} prompts carregados`);
    return prompts;
  } catch (error) {
    console.error('âŒ Erro ao carregar prompts:', error);
    throw error;
  }
}

/**
 * Busca um prompt especÃ­fico por ID
 * @param {string} id - ID do prompt
 * @returns {Promise&lt;Object|null>} Prompt encontrado ou null
 */
export async function getPromptById(id) {
  try {
    const prompts = await getAllPrompts();
    const prompt = prompts.find(p => p.id === id);
    
    if (prompt) {
      console.log(`ðŸ“‹ Prompt encontrado: ${prompt.title}`);
      return prompt;
    } else {
      console.log(`âš ï¸ Prompt nÃ£o encontrado: ${id}`);
      return null;
    }
  } catch (error) {
    console.error('âŒ Erro ao buscar prompt:', error);
    throw error;
  }
}

/**
 * Cria um novo prompt
 * @param {Object} promptData - Dados do novo prompt
 * @returns {Promise&lt;Object>} Prompt criado
 */
export async function createPrompt(promptData) {
  try {
    console.log('âž• Criando novo prompt...');
    
    // Validar dados obrigatÃ³rios
    if (!promptData.title || !promptData.content) {
      throw new Error('TÃ­tulo e conteÃºdo sÃ£o obrigatÃ³rios');
    }
    
    // Criar estrutura do prompt
    const newPrompt = createPromptStructure(promptData);
    
    // Carregar prompts existentes
    const prompts = await getAllPrompts();
    
    // Adicionar novo prompt
    prompts.push(newPrompt);
    
    // Salvar no arquivo
    await writeJSONFile(config.data.promptsFile, prompts);
    
    console.log(`âœ… Prompt criado: ${newPrompt.title}`);
    return newPrompt;
  } catch (error) {
    console.error('âŒ Erro ao criar prompt:', error);
    throw error;
  }
}

/**
 * Atualiza um prompt existente
 * @param {string} id - ID do prompt
 * @param {Object} updateData - Dados para atualizar
 * @returns {Promise&lt;Object|null>} Prompt atualizado ou null
 */
export async function updatePrompt(id, updateData) {
  try {
    console.log(`ðŸ“ Atualizando prompt: ${id}`);
    
    const prompts = await getAllPrompts();
    const promptIndex = prompts.findIndex(p => p.id === id);
    
    if (promptIndex === -1) {
      console.log(`âš ï¸ Prompt nÃ£o encontrado para atualizaÃ§Ã£o: ${id}`);
      return null;
    }
    
    // Manter dados originais e atualizar apenas os novos
    const updatedPrompt = createPromptStructure({
      ...prompts[promptIndex],
      ...updateData,
      id: prompts[promptIndex].id, // Garantir que ID nÃ£o muda
      createdAt: prompts[promptIndex].createdAt // Manter data de criaÃ§Ã£o
    });
    
    prompts[promptIndex] = updatedPrompt;
    
    await writeJSONFile(config.data.promptsFile, prompts);
    
    console.log(`âœ… Prompt atualizado: ${updatedPrompt.title}`);
    return updatedPrompt;
  } catch (error) {
    console.error('âŒ Erro ao atualizar prompt:', error);
    throw error;
  }
}

/**
 * Remove um prompt
 * @param {string} id - ID do prompt
 * @returns {Promise&lt;boolean>} True se removido com sucesso
 */
export async function deletePrompt(id) {
  try {
    console.log(`ðŸ—‘ï¸ Removendo prompt: ${id}`);
    
    const prompts = await getAllPrompts();
    const initialLength = prompts.length;
    const filteredPrompts = prompts.filter(p => p.id !== id);
    
    if (filteredPrompts.length === initialLength) {
      console.log(`âš ï¸ Prompt nÃ£o encontrado para remoÃ§Ã£o: ${id}`);
      return false;
    }
    
    await writeJSONFile(config.data.promptsFile, filteredPrompts);
    
    console.log(`âœ… Prompt removido com sucesso`);
    return true;
  } catch (error) {
    console.error('âŒ Erro ao remover prompt:', error);
    throw error;
  }
}

/**
 * Busca prompts com filtros
 * @param {Object} filters - Filtros de busca
 * @returns {Promise&lt;Array>} Prompts filtrados
 */
export async function searchPrompts(filters = {}) {
  try {
    console.log('ðŸ” Buscando prompts com filtros:', filters);
    
    let prompts = await getAllPrompts();
    
    // Filtrar por termo de busca (tÃ­tulo, descriÃ§Ã£o, conteÃºdo)
    if (filters.search) {
      const searchTerm = filters.search.toLowerCase();
      prompts = prompts.filter(prompt => 
        prompt.title.toLowerCase().includes(searchTerm) ||
        prompt.description.toLowerCase().includes(searchTerm) ||
        prompt.content.toLowerCase().includes(searchTerm) ||
        prompt.tags.some(tag => tag.toLowerCase().includes(searchTerm))
      );
    }
    
    // Filtrar por categoria
    if (filters.category) {
      prompts = prompts.filter(prompt => prompt.category === filters.category);
    }
    
    // Filtrar por tom
    if (filters.tone) {
      prompts = prompts.filter(prompt => prompt.tone === filters.tone);
    }
    
    // Filtrar por tag
    if (filters.tag) {
      prompts = prompts.filter(prompt => 
        prompt.tags.includes(filters.tag)
      );
    }
    
    // Ordenar resultados
    const sortBy = filters.sortBy || 'updatedAt';
    const sortOrder = filters.sortOrder || 'desc';
    
    prompts.sort((a, b) => {
      let comparison = 0;
      
      switch (sortBy) {
        case 'title':
          comparison = a.title.localeCompare(b.title);
          break;
        case 'createdAt':
          comparison = new Date(a.createdAt) - new Date(b.createdAt);
          break;
        case 'updatedAt':
          comparison = new Date(a.updatedAt) - new Date(b.updatedAt);
          break;
        case 'usageCount':
          comparison = a.usageCount - b.usageCount;
          break;
        default:
          comparison = new Date(a.updatedAt) - new Date(b.updatedAt);
      }
      
      return sortOrder === 'asc' ? comparison : -comparison;
    });
    
    console.log(`âœ… ${prompts.length} prompts encontrados`);
    return prompts;
  } catch (error) {
    console.error('âŒ Erro ao buscar prompts:', error);
    throw error;
  }
}

/**
 * Incrementa contador de uso de um prompt
 * @param {string} id - ID do prompt
 * @returns {Promise&lt;Object|null>} Prompt atualizado
 */
export async function incrementUsage(id) {
  try {
    const prompt = await getPromptById(id);
    if (!prompt) return null;
    
    return await updatePrompt(id, {
      usageCount: (prompt.usageCount || 0) + 1
    });
  } catch (error) {
    console.error('âŒ Erro ao incrementar uso:', error);
    throw error;
  }
}

/**
 * ObtÃ©m estatÃ­sticas dos prompts
 * @returns {Promise&lt;Object>} EstatÃ­sticas
 */
export async function getPromptsStats() {
  try {
    const prompts = await getAllPrompts();
    
    const stats = {
      total: prompts.length,
      categories: {},
      tones: {},
      tags: {},
      totalUsage: prompts.reduce((sum, p) => sum + (p.usageCount || 0), 0),
      mostUsed: prompts.sort((a, b) => (b.usageCount || 0) - (a.usageCount || 0)).slice(0, 5),
      recent: prompts.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt)).slice(0, 5)
    };
    
    // Contar categorias
    prompts.forEach(prompt => {
      stats.categories[prompt.category] = (stats.categories[prompt.category] || 0) + 1;
    });
    
    // Contar tons
    prompts.forEach(prompt => {
      stats.tones[prompt.tone] = (stats.tones[prompt.tone] || 0) + 1;
    });
    
    // Contar tags
    prompts.forEach(prompt => {
      prompt.tags.forEach(tag => {
        stats.tags[tag] = (stats.tags[tag] || 0) + 1;
      });
    });
    
    return stats;
  } catch (error) {
    console.error('âŒ Erro ao obter estatÃ­sticas:', error);
    throw error;
  }
}

/**
 * Cria prompts de exemplo para inicializar o sistema
 * @returns {Array} Lista de prompts de exemplo
 */
function createExamplePrompts() {
  const examples = [
    {
      title: 'Resumo de Artigo AcadÃªmico',
      description: 'Cria resumos concisos de artigos cientÃ­ficos mantendo os pontos principais',
      content: 'Resuma o seguinte artigo acadÃªmico em 3 pontos principais, mantendo o tom cientÃ­fico e destacando:\n\n1. Objetivo principal do estudo\n2. Metodologia utilizada\n3. ConclusÃµes e implicaÃ§Ãµes\n\nArtigo: [COLAR TEXTO DO ARTIGO AQUI]\n\nFormato: Use marcadores para cada ponto e seja conciso mas informativo.',
      category: 'Estudos',
      tags: ['resumo', 'acadÃªmico', 'pesquisa', 'cientÃ­fico'],
      tone: 'Formal',
      isExample: true
    },
    {
      title: 'Post Criativo para Instagram',
      description: 'Gera posts envolventes para Instagram com hooks, emojis e hashtags',
      content: 'Crie um post para Instagram sobre [TEMA/PRODUTO] seguindo esta estrutura:\n\nðŸ“± HOOK inicial (primeira linha que prende atenÃ§Ã£o)\nðŸ’¡ Desenvolvimento do tema (2-3 frases explicativas)\nðŸŽ¯ Call-to-action no final\n\nUse:\n- Emojis relevantes\n- Tom [casual/profissional]\n- 5-7 hashtags populares\n- MÃ¡ximo 150 palavras\n\nObjetivo: [engajar/vender/informar/educar]',
      category: 'Marketing',
      tags: ['instagram', 'redes sociais', 'post', 'engajamento'],
      tone: 'Criativo',
      isExample: true
    },
    {
      title: 'Debug e AnÃ¡lise de CÃ³digo',
      description: 'Analisa cÃ³digos em busca de bugs, melhorias de performance e boas prÃ¡ticas',
      content: 'Analise o seguinte cÃ³digo [LINGUAGEM] e forneÃ§a:\n\nðŸ” **ANÃLISE DE BUGS:**\n- PossÃ­veis erros de lÃ³gica\n- Problemas de sintaxe\n- Casos extremos nÃ£o tratados\n\nâš¡ **OTIMIZAÃ‡ÃƒO:**\n- Melhorias de performance\n- RefatoraÃ§Ã£o sugerida\n- PadrÃµes mais eficientes\n\nâœ… **BOAS PRÃTICAS:**\n- ConvenÃ§Ãµes de nomenclatura\n- Estrutura do cÃ³digo\n- DocumentaÃ§Ã£o necessÃ¡ria\n\nCÃ³digo:\n[COLAR CÃ“DIGO AQUI]',
      category: 'ProgramaÃ§Ã£o',
      tags: ['debug', 'cÃ³digo', 'programaÃ§Ã£o', 'otimizaÃ§Ã£o'],
      tone: 'TÃ©cnico',
      isExample: true
    },
    {
      title: 'E-mail Profissional Personalizado',
      description: 'Redige e-mails profissionais para diferentes contextos e destinatÃ¡rios',
      content: 'Redija um e-mail profissional com os seguintes parÃ¢metros:\n\nðŸ“§ **CONTEXTO:**\nDestinatÃ¡rio: [NOME/CARGO]\nAssunto: [TEMA PRINCIPAL]\nObjetivo: [informar/solicitar/agradecer/resolver]\nTom: [formal/cordial/urgente]\n\nðŸ“ **ESTRUTURA:**\n- SaudaÃ§Ã£o adequada ao contexto\n- IntroduÃ§Ã£o clara do motivo\n- Desenvolvimento organizado\n- Call-to-action especÃ­fico\n- Fechamento profissional\n\nâ° UrgÃªncia: [baixa/mÃ©dia/alta]\nðŸŽ¯ Resultado esperado: [DESCREVER]',
      category: 'Atendimento',
      tags: ['email', 'comunicaÃ§Ã£o', 'profissional', 'negÃ³cios'],
      tone: 'Formal',
      isExample: true
    },
    {
      title: 'Brainstorm de Ideias Criativas',
      description: 'Gera mÃºltiplas ideias criativas para projetos, campanhas ou soluÃ§Ãµes',
      content: 'FaÃ§a um brainstorm criativo sobre [TEMA/DESAFIO] gerando:\n\nðŸ’¡ **10 IDEIAS PRINCIPAIS:**\n(Numere de 1-10, seja especÃ­fico e criativo)\n\nðŸŽ¨ **3 CONCEITOS INOVADORES:**\n- Ideia disruptiva 1: [explicaÃ§Ã£o]\n- Abordagem inusitada 2: [explicaÃ§Ã£o] \n- SoluÃ§Ã£o criativa 3: [explicaÃ§Ã£o]\n\nðŸŽ¯ **CRITÃ‰RIOS:**\n- PÃºblico-alvo: [DEFINIR]\n- OrÃ§amento: [baixo/mÃ©dio/alto]\n- Prazo: [DEFINIR]\n- Objetivo: [DEFINIR]\n\nPense fora da caixa e explore diferentes Ã¢ngulos!',
      category: 'Criatividade',
      tags: ['brainstorm', 'ideias', 'criatividade', 'inovaÃ§Ã£o'],
      tone: 'Criativo',
      isExample: true
    }
  ];
  
  return examples.map(prompt => createPromptStructure(prompt));
}</code></pre>
        </article>
    </section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>


</body>
</html>
